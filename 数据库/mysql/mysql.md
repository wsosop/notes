# 一、数据库概述

## 1.1）数据库相关概念

### 1.1.1）数据库的好处

- 1.持久化数据到本地    
- 2.可以实现结构化查询，方便管理            

### 1.1.2）数据库相关概念

- 1、**DB**：**数据库，保存一组有组织的数据的容器**    
- 2、DBMS：数据库管理系统，又称为**数据库软件（产品）**，用于管理DB中的数据    
- 3、SQL:结构化查询语言，用于和DBMS通信的语言        

### 1.1.3）数据库存储数据的特点

- 1、**将数据放到表中（相当于文件页），表再放到库中，数据先放到文件页中，再放入数据库中。**
- 2、一个数据库中可以有多个表，每个表都有一个的名字，用来标识自己。表名具有唯一性。
- 3、表具有一些特性，这些特性定义了数据在表中如何存储，类似java中 “类”的设计。
- 4、表由列组成，我们也称为字段。所有表都是由一个或多个列组成的，每一列类似java 中的”属性”
- 5、**表中的数据是按行存储的，每一行类似于java中的“对象”。**

## 1.2）MySQL产品的介绍和安装

### 1.2.1）MySQL服务的启动和停止

```mysql
	方式一：计算机——右击管理——服务
	方式二：通过管理员身份运行
	net start 服务名（启动服务）
	net stop 服务名（停止服务）
```

### 1.2.2）MySQL服务的登录和退出   

```mysq
方式一：通过mysql自带的客户端
	只限于root用户

​	方式二：通过windows自带的客户端
​	登录：
​	mysql 【-h主机名 -P端口号 】-u用户名 -p密码

​	退出：
​	exit或ctrl+C
```

### 1.2.3）MySQL的常见命令      

```mysql
#1.查看当前所有的数据库
show databases;
#2.打开指定的库
use 库名
#3.查看当前库的所有表
show tables;
#4.查看其它库的所有表
show tables from 库名;
#5.创建表
create table 表名(
	列名 列类型,
	列名 列类型，
	。。。
);
#6.查看表结构
desc 表名;
#7.查看服务器的版本
方式一：登录到mysql服务端
select version();
方式二：没有登录到mysql服务端
mysql --version
或
mysql --V
```

### 1.2.4）MySQL的语法规范

- 1.**不区分大小写**,但建议关键字大写，表名、列名小写
- 2.每条命令**最好用分号结尾**
- 3.每条命令根据需要，**可以进行缩进 或换行**
- 4.**注释**
  		单行注释：#注释文字
    		单行注释：-- 注释文字 （注意杠杠和注释文字之间要有空格）
    		多行注释：/* 注释文字  */

### 1.2.5）SQL的语言分类

- **DQL（Data Query Language）：数据查询语言**
  		`select` 
- **DML(Data Manipulate Language):数据操作语言**
  		`insert 、update、delete`
- **DDL（Data Define Languge）：数据定义语言**
  		`create、drop、alter`
- **TCL（Transaction Control Language）：事务控制语言**
  		`commit、rollback`



# 二、DQL(DataBase Query Language)语言学习

## 2.1）基础查询【进阶一-基础查询】

### 2.1.1）语法

`select 查询列表 from 表名;`

### 2.1.2）特点

- 1、**查询列表**可以是**字段、常量、表达式、函数，也可以是多个**
- 2、**查询结果是一个虚拟表**

### 2.1.3）示例

#### 2.1.3.1）查询单个字段

`select 字段名 from 表名;`

#### 2.1.3.2）查询多个字段

`select 字段名，字段名 from 表名;`

#### 2.1.3.3）查询所有字段

`select * from 表名;`

#### 2.1.3.4）查询常量

`select 常量值;`

**注意**：字符型和日期型的常量值必须用单引号引起来，数值型不需要

#### 2.1.3.5）查询函数

`select 函数名(实参列表);`

#### 2.1.3.6）查询表达式

`select 100/1234;`

#### 2.1.3.7）起别名

- ①as

- ②空格

#### 2.1.3.8）去重

`select distinct 字段名 from 表名;`

#### 2.1.3.9）+  作用：做加法运算

- `select 数值+数值;`  直接运算

- `select 字符+数值;` 先试图将字符转换成数值，如果转换成功，则继续运算；否则转换成0，再做运算

- `select null+值; `  结果都为null，只要有一方为null 则就为 null

#### 2.1.3.10）【补充】concat函数 功能：拼接字符

`select concat(字符1，字符2，字符3,...);`

#### 2.1.3.11）【补充】ifnull函数 功能：判断某字段或表达式是否为null，如果为null 返回指定的值，否则返回原本的值

`select ifnull(commission_pct,0) from employees;`

#### 2.1.3.12）【补充】isnull函数 功能：判断某字段或表达式是否为null，如果是，则返回1，否则返回0

`SELECT ISNULL(commission_pct) AS "奖金",commission_pct FROM employees;`

## 2.2）条件查询【进阶二-条件查询】

### 2.2.1）语法

`select 查询列表 from 表名 where 筛选条件`

### 2.2.2）筛选条件的分类

#### 2.2.2.1）简单条件运算符

`< = <> != >= <=  <=>安全等于`

#### 2.2.2.2）逻辑运算符

`&& and`
`|| or`
`!  not`

#### 2.2.2.3）模糊查询

`like`:一般搭配通配符使用，可以判断字符型或数值型

**通配符**：`%`任意多个字符，`_`任意单个字符

`between and` ：范围  在值之间
`in` ：在什么中
`is null /is not null`：用于判断null值

#### 2.2.2.4）`is null` 对比 `<=>`

|         | 普通类型的数值 | null值 | 可读性 |
| ------- | -------------- | ------ | ------ |
| is null | ×              | √      | √      |
| <=>     | √              | √      | ×      |

## 2.3）排序查询[进阶三-排序查询]

### 2.3.1）语法

`select 查询列表`
`from 表`
`where 筛选条件`
`order by 排序列表 【asc|desc】`

### 2.3.2）特点

- 1、升降序
  - `asc` ：升序，如果不写默认升序
  - `desc`：降序

- 2、排序列表 支持 单个字段、多个字段、函数、表达式、别名

- 3、`order by`的位置一般放在查询语句的最后（除`limit`语句之外）

## 2.4）常见函数[进阶四-常见的函数]

### 2.4.1）概述

- 功能：**类似于java中的方法**

- 好处：提高重用性和隐藏实现细节
- 调用：`select 函数名(实参列表);`

### 2.4.2）单行函数

#### 2.4.2.1）字符函数

- `concat`:连接
- `substr:`截取子串
- `upper`:变大写
- `lower`：变小写
- `replace`：替换
- `length`：获取字节长度
- `trim`:去前后空格
- `lpad`：左填充
- `rpad`：右填充
- `instr`:获取子串第一次出现的索引

#### 2.4.2.2）数学函数

`ceil`:向上取整
`round`：四舍五入
`mod`:取模
`floor`：向下取整
`truncate`:截断
`rand`:获取随机数，返回0-1之间的小数

#### 2.4.2.3）日期函数

`now`：**返回当前日期+时间**
`year`:返回年
`month`：返回月
`day`:返回日
`date_format`:**将日期转换成字符**
`curdate`:返回当前日期
`str_to_date`:**将字符转换成日期**
`curtime`：**返回当前时间**
`hour`:小时
`minute`:分钟
`second`：秒
`datediff`:**返回两个日期相差的天数**
`monthname`:**以英文形式返回月**

#### 2.4.2.4）其他函数

`version() ` 当前数据库服务器的版本
`database()` 当前打开的数据库
`user()`当前用户
`password('字符')`：返回该字符的密码形式
`md5('字符')`:返回该字符的md5加密形式

#### 2.4.2.5）流程控制函数

- ①`if(条件表达式，表达式1，表达式2)：如果条件表达式成立，返回表达式1，否则返回表达式2`

- ②**case情况1(类似java switch语句)**

  `case 变量或表达式或字段`
  `when 常量1 then 值1`
  `when 常量2 then 值2`
  `...`
  `else 值n`
  `end`

- ③**case情况2(类似java if(){} else if{}else{} )**

  `case` 
  `when 条件1 then 值1`
  `when 条件2 then 值2`
  `...`
  `else 值n`
  `end`

### 2.4.3）分组函数

#### 2.4.3.1）分类

`max` 最大值
`min` 最小值
`sum` 和
`avg` 平均值
`count` 计算个数

#### 2.4.3.2）特点

- ①**语法**
  `select max(字段) from 表名;`

- ②支持的类型
  - **sum和avg一般用于处理数值型**
  - **max、min、count**可以处理**任何数据类型**

- ③**以上分组函数都忽略null(重点)**

- ④**都可以搭配distinct使用**，实现去重的统计
  - `select sum(distinct 字段) from 表;`

- ⑤count函数

  - `count(字段)`：**统计**该字段**非空值的个数**
  - `count(*)`:统计结果集的行数
  - `count(1)`:统计结果集的行数

  效率上：     

  MyISAM存储引擎，`count(*)`最高    
  InnoDB存储引擎，`count(*)`和`count(1)`效率>`count(字段)`     

- ⑥ **和分组函数一同查询的字段，要求是group by后出现的字段（重点）**

## 2.5）分组查询【进阶五-分组查询】

### 2.5.1）语法

`select 分组函数，分组后的字段`
`from 表`
`【where 筛选条件】`
  `group by 分组的字段`
`【having 分组后的筛选】`
`【order by 排序列表】`

### 2.5.2）特点

|            | 使用关键字 | 筛选的表     | 位置            |
| ---------- | ---------- | ------------ | --------------- |
| 分组前筛选 | where      | 原始表       | group by的前面  |
| 分组后筛选 | having     | 分组后的结果 | group by 的后面 |

## 2.6）连接查询【进阶六-连接查询-92标准|进阶六-连接查询-99连接查询】

### 2.6.1）含义

当查询中涉及到了多个表的字段，需要使用多表连接          

`select 字段1，字段2 from 表1，表2,...;`

笛卡尔乘积：当查询多个表时，**没有添加有效的连接条件，导致多个表所有行实现完全连接**     
如何解决：添加有效的连接条件

### 2.6.2）分类

- 按年代分类：

  - sql92：
    - 等值
    - 非等值
    - 自连接
    - 也支持一部分外连接（用于oracle、sqlserver，mysql不支持）

  - **sql99【推荐使用】**

    - 内连接
      - 等值
      - 非等值
      - 自连接

    - 外连接
      - 左外
      - 右外
      - 全外（mysql不支持）

    - 交叉连接

### 2.6.3）SQL92语法

#### 2.6.3.1）等值连接

##### 2.6.3.1.1）语法：

`select 查询列表`
	`from 表1 别名,表2 别名`
	`where 表1.key=表2.key`
	`【and 筛选条件】`
	`【group by 分组字段】`
	`【having 分组后的筛选】`
	`【order by 排序字段】` 

##### 2.6.3.1.2）特点：

- ① 一般为表起别名

- ②多表的顺序可以调换
- ③n表连接至少需要n-1个连接条件
- ④等值连接的结果是多表的交集部分

#### 2.6.3.2）非等值连接

##### 2.6.3.2.1）语法：

​	`select 查询列表`
​	`from 表1 别名,表2 别名`
​	`where 非等值的连接条件`
​	`【and 筛选条件】`
​	`【group by 分组字段】`
​	`【having 分组后的筛选】`
​	`【order by 排序字段】`

#### 2.6.3.3）自连接

##### 2.6.3.3.1）语法：

​	`select 查询列表`
​	`from 表 别名1,表 别名2`
​	`where 等值的连接条件`
​	`【and 筛选条件】`
​	`【group by 分组字段】`
​	`【having 分组后的筛选】`
​	`【order by 排序字段】`

### 2.6.4）SQL99语法

#### 2.6.4.1）内连接











